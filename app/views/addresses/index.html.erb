


<div id="address_container">
  
  <div id="all_user_addresses">
    
    <% if @selected_shipping.nil? %>
      <%= render partial: 'form' %>
    <% else %>
     <h3>Shipping Address</h3>
      <%= render partial: 'selected_address_shipping', locals: {address: @selected_shipping} %>
      

    <% end %>
  
    <% if @selected_billing.nil? %>
      <%= render partial: 'new_billing_address' %>
    <% else %>
      <% unless @the_same_addresses == true %>
        <h3>Billing address</h3>
        <%= render partial: 'selected_address_billing', locals: {address: @selected_billing} %>
        

      <% end %>
    <% end %>
 
      <script type="text/javascript">
        function show_billing_form() {
          var billing_form = document.getElementsByName('billing_form')[0];
           if(this.checked) {
             billing_form.style.display = 'none';
           } else {
             billing_form.style.display = 'block';
           }
        };
      </script>

  </div>

  
<!--  If user is ordering -->
<% unless @cart.number_of_products == 0 %>
  <div class="step">Step 2 of 2</div>
  <%= render partial: "carts/order_cart" %>
<% end %>


  <div class="buttons">
    <%= button_to 'Back to Cart', cart_path(@cart.id), method: :get, class: 'cancel_button' %>
  	<%=form_tag '/orders/create_order' do %>
      <% if session[:shipping_id] && session[:billing_id] %>
      	<script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                data-key="pk_test_Cnh27zogL5NcjyVeTcLBWmle"
                data-description="Pay for your items"
                data-amount="<%= (@cart.total_delivery_and_products_price*100).to_i %>">
        </script>

      <% else %>
        Pick your shipping and billing addresses, please.
      <% end %>
  <% end %>
  </div>
</div>